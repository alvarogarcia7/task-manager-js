<!DOCTYPE html>
<html lang="en">

<body>

<div>


<input type="button" id="removedAll" name="removedAll" value="clear tasks" onclick="viewModel.removeAll()";/>
<!-- <input type="button" onclick="localStorage.clear();;" value="Clear all localStorage"/> -->
<input type="button" onclick="javascript:console.log(viewModel.tasks());" value="View tasks in console.log"/>
<input type="button" onclick="javascript:viewModel.retrieveFromServer();" value="Retrieve from server"/>
<input type="button" onclick="javascript:viewModel.saveToServer();" value="Save to server"/>



<script type="text/javascript" src="../../../lib/knockoutjs/knockout-3.0.0.debug.js"></script>
<script type="text/javascript" src="../../../lib/cufon-yui.js"></script>
<script type="text/javascript" src="../../../lib/titilliummaps.font.js"></script>
<script type="text/javascript" src="../../../lib/knockoutjs/json2.js"></script>

<script type="text/javascript" src="../../../lib/knockoutjs/switch-case/knockout-switch-case.js"></script>

<link href="../../../lib/bootstrap-3.0.2/css/bootstrap.css" rel="stylesheet"/> 
<link href="../../../lib/bootstrap-3.0.2/css/bootstrap-theme.css" rel="stylesheet"/> 

<script src="../../../lib/jquery-2.0.3/jquery-2.0.3.min.js"></script>
<script src="../../../lib/jquery-2.0.3/jquery.json-2.4.js"></script>
<script src="../../../lib/modernizr/modernizr.js"></script>
<script src="../js/common-functions.js"></script>
<script src="../js/App.js"></script>
<script type="text/javascript" src="../../../lib/bootstrap-3.0.2/js/bootstrap.js"></script>
<!-- <link href="http://www.jsviews.com/samples/samples.css" rel="stylesheet"/> -->
<link href="../styles/tango32.css" rel="stylesheet"/>




<div class='liveExample' class="container-fluid separate-rows tall-rows"> 

	<div>
	<!-- ko switch -->
		<div data-bind="case.visible: !$root.newTask()" class="row-fluid">
			<a class="action newTask" id="addNewTaskButton" data-bind='click: $root.createNewTask' title="Add new task"></a>
		</div>

		<div data-bind="case.visible: $else" class="row-fluid">
			<input type="text" id="taskName"
				 data-bind="value: $root.currentItem().name, valueUpdate:'afterkeydown'"
				 onchange="console.log('changed name. now = '+$(this).val());"
				 value="tarea dificil" class="new" />
			<input type="text" id="taskDate"
				data-bind="value: $root.currentItem().deadline, valueUpdate:'afterkeydown'"
				value="el aÃ±o que viene"  class="new" />
			<a class="action commitNewTask" id="addButton" data-bind='click: $root.add' title="Add task"></a>
			<a class="action rollbackNewTask" data-bind='click: $root.rollbackTask' title="Cancel"></a>
		</div>
	<!-- /ko -->
	</div>

	
    
    <form class="form-vertical">

        <div class="row-fluid">You have asked for <span data-bind='text: tasks().length'>&nbsp;</span> task(s)</div>
        
        <div class="row-fluid">
				ID
                task name
                deadline
        </div>
        <div data-bind='foreach: tasks'>
        	<div class="row">
        		<div class="col-xs-0 col-md-1 " data-bind='text: id'></div>
        	<!-- ko switch -->
			    <!-- ko case: $parent.currentItem()  && $data.id == $parent.currentItem().id  -->
				    <div class="col-xs-12 col-md-4"><input class='inlined required' data-bind='value: name' onkeypress="
							if(isEnter(event,true)){
					    		$('#commitTask')[0].click();
					    	}
				    	" /></div>
                    <div class="col-xs-12 col-md-2"><input class='inlined required number' data-bind='value: deadline' onkeypress="
							if(isEnter(event,true)){
					    		$('#commitTask')[0].click();
					    	}
				    	" /></div>

					<div class="col-xs-12 col-md-3">
					  <a id="rollbackTask" class="action rollbackEditTask" href='#' data-bind='click: $root.rollbackTask' title="Discard changes" ></a>
                      <a id="commitTask"   class="action commitEditTask"   href='#' data-bind='click:$root.commitTask;' title="Save changes" ></a>
                    </div>
                    <div class="col-md-1">&nbsp;</div>
			    <!-- /ko --> <!-- ko case: $else -->
			    	<div class="col-xs-9 col-md-4">
                      <span class='required ' data-bind='text: name' /></span>
                	</div>
			    	<div class="col-xs-6 col-md-2">
                      <span class='required number ' data-bind='text: deadline' /></span>
                    </div>
			    	<div class="col-xs-6 col-md-2">
	                  <a class="action editTask" href='#' data-bind='click: $root.editTask' title="Edit task"></a>
	                  <a class="action deleteTask" href='#' data-bind='click: function(data,event){ $parent.removeTask(data,true); };' title="Delete task"></a>
                	</div>

                <!-- /ko -->
        	<!-- /ko -->
        </div>
			<!-- $data is the current element:
			http://knockoutjs.com/documentation/foreach-binding.html see note 1 -->
		</div>
</div>
     
        
        <!-- <button  data-bind='enable: tasks().length > 0' type='submit'>Submit</button> -->
    </form>
    <!-- <pre><span data-bind='text: $.toJSON(tasks(), null, 2)'>&nbsp;</span></pre> -->
    
</div>

<script type="text/javascript">

$(document).ready(function(){


 viewModel = new App();
 //viewModel.addDummyData();
 ko.applyBindings(viewModel);
 // viewModel.retrieveFromServer();
 viewModel.retrieveFromStorage();


 $('input.new').on('keypress',function(event){
 	if(isEnter(event,true)){
		$('#addButton')[0].click();
	}
  });

 $('input.inlined').on('keypress',function(event){
 	if(isEnter(event,true)){
		$('#commitTask').click();
	}
  });
});

</script>


<script>
var viewModel;
</script>
</body>
</html>

